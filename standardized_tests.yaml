steps:
- script: |
    electrumsv-sdk install node
    electrumsv-sdk install electrumx
    electrumsv-sdk install electrumsv
    electrumsv-sdk install whatsonchain
    electrumsv-sdk install merchant_api
  displayName: 'install all components'

- script: |
    electrumsv-sdk start --background status_monitor
    electrumsv-sdk start --background --new node
    electrumsv-sdk start --background --new electrumx
    electrumsv-sdk start --background --new --deterministic-seed electrumsv
    electrumsv-sdk node generate 1
    electrumsv-sdk start --background whatsonchain
    electrumsv-sdk start --background merchant_api
    electrumsv-sdk status
    python3 ./contrib/check_all_started.py
  displayName: 'start all components'
  continueOnError: true

- script: |
    electrumsv-sdk stop node
    electrumsv-sdk stop electrumx
    electrumsv-sdk stop electrumsv
    electrumsv-sdk stop whatsonchain
    electrumsv-sdk stop status_monitor
    electrumsv-sdk stop merchant_api
    electrumsv-sdk status
    python3 ./contrib/check_all_stopped.py
  displayName: 'stop all components'
  continueOnError: true

- script: |
    sleep 5
    electrumsv-sdk reset
    electrumsv-sdk status
  displayName: 'reset all components'
  continueOnError: true

- script: |
    sleep 5
    electrumsv-sdk reset --id=node1 node
    electrumsv-sdk reset --id=electrumx1 electrumx
    electrumsv-sdk reset --id=electrumsv1 --deterministic-seed electrumsv
    electrumsv-sdk status
  displayName: 'reset by id'
  continueOnError: true
